<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">

    <title>MediSync</title>

    <!-- Bootstrap Core CSS -->
    <link href="../bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- MetisMenu CSS -->
    <link href="../bower_components/metisMenu/dist/metisMenu.min.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="../dist/css/sb-admin-2.css" rel="stylesheet">
    <link href="../dist/css/d3.css" rel="stylesheet" type="text/css">
    <link href="../css/custom.css" rel="stylesheet" type="text/css">
    <link href='http://fonts.googleapis.com/css?family=Titillium+Web:400,200,300,600,700' rel='stylesheet' type='text/css'>
    
    <!-- Custom Fonts -->
    <link href="../bower_components/font-awesome/css/font-awesome.min.css" rel="stylesheet" type="text/css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
        <![endif]-->

    </head>

    <body>
        <div id="wrapper">

            <!-- Navigation -->
            <nav class="navbar navbar-default navbar-static-top" role="navigation" style="margin-bottom: 0">
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-brand" href="index.html">MediSync</a>
                </div>

                <div class="navbar-default sidebar" role="navigation">
                    <div class="sidebar-nav navbar-collapse">
                        <ul class="nav" id="side-menu">
                            <li>
                                <a href="index.html"><i class="fa fa-file-movie-o fa-fw"></i> My Story</a>
                            </li>
                            <li>
                                <a href="history.html"><i class="fa fa-folder-open-o fa-fw"></i> Health History</a>
                            </li>
                            <li>
                                <a href="medication.html"><i class="fa fa-clock-o fa-fw"></i> Medication History</a>
                            </li>
                            <li>
                                <a href="allergies.html"><i class="fa fa-table fa-fw"></i> Allergies</a>
                            </li>
                            <li>
                                <a href="results.html"><i class="fa fa-line-chart fa-fw"></i> Test Results</a>
                            </li>
                            <li>
                                <a href="scans.html"><i class="fa fa-image fa-fw"></i> Scans</a>
                            </li>
                            <li>
                                <a href="social.html"><i class="fa fa-user fa-fw"></i> Social History</a>
                            </li>
                            <li>
                                <a href="providers.html"><i class="fa fa-heartbeat fa-fw"></i> Providers</a>
                            </li>
                        </ul>
                    </div>
                    <!-- /.sidebar-collapse -->
                </div>
                <!-- /.navbar-static-side -->
            </nav>

            <!-- Page Content -->
            <div id="page-wrapper">
                <div class="container-fluid">
                    <div class="row">
                        <div class="col-lg-12">
                            <h1 class="page-header">Test Results</h1>
                        </div>
                        <!-- /.col-lg-12 -->
                    </div>
                    <div class="row">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <i></i> Blood Pressure
                            </div>
                            <!-- /.panel-heading -->

                            <div id="d3bloodpressure">
                                <svg></svg>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                                <i></i> Cholesterol
                            </div>
                            <!-- /.panel-heading -->

                            <div id="d3cholesterol">
                                <svg></svg>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="panel panel-default">
                            <div class="panel-heading">
                               <i class="fa"></i> CBC
                           </div>
                           <!-- /.panel-heading -->
                           <div class="panel-body">
                            <div class="dataTable_wrapper">
                                <table class="table table-striped table-bordered table-hover" id="resultDataTable">
                                </table>
                            </div>
                            <!-- /.table-responsive -->
                        </div>
                        <!-- /.panel-body -->
                    </div>
                </div>
                <div class="row">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                           <i class="fa"></i> RBC
                       </div>
                       <div class="panel-body">
                        <div class="progress">
                            <div class="progress-bar progress-bar-danger" role="progressbar" style="width:40%">
                                Low RBC (0.0 - 4.2)
                            </div>
                            <div class="progress-bar progress-bar-success" role="progressbar" style="width:60%">
                                Normal RBC (> 4.2)
                            </div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar"
                            aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:20%">
                            Current Patient RBC (3.83)</div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                           <i class="fa"></i> WBC
                       </div>
                       <div class="panel-body">
                        <div class="progress">
                            <div class="progress-bar progress-bar-danger" role="progressbar" style="width:20%">
                                Low WBC (0.0 - 5000)
                            </div>
                            <div class="progress-bar progress-bar-success" role="progressbar" style="width:40%">
                                Normal WBC (5000 - 10000)
                            </div>
                            <div class="progress-bar progress-bar-danger" role="progressbar" style="width:40%">
                                High WBC (> 10000)
                            </div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar progress-bar-info progress-bar-striped active" role="progressbar"
                            aria-valuenow="40" aria-valuemin="0" aria-valuemax="100" style="width:65%">
                            Current Patient WBC (12730)</div>
                        </div>
                    </div>
                </div>
            </div>
            <!-- /.row -->
        </div>
        <!-- /.container-fluid -->
    </div>
    <!-- /#page-wrapper -->

</div>
<!-- /#wrapper -->

<!-- jQuery -->
<script src="../bower_components/jquery/dist/jquery.min.js"></script>

<!-- Bootstrap Core JavaScript -->
<script src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

<!-- Metis Menu Plugin JavaScript -->
<script src="../bower_components/metisMenu/dist/metisMenu.min.js"></script>

<!-- Custom Theme JavaScript -->
<script src="../dist/js/sb-admin-2.js"></script>


<!-- DataTables JavaScript -->
<script src="../bower_components/datatables/media/js/jquery.dataTables.min.js"></script>
<script src="../bower_components/datatables-plugins/integration/bootstrap/3/dataTables.bootstrap.min.js"></script>

<script src="http://mbostock.github.com/d3/d3.v2.js"></script>
<script src="../dist/js/nvtooltip.js"></script>
<script src="../dist/js/d3legend.js"></script> 
<script src="../dist/js/d3line.js"></script> 
<script src="../dist/js/d3linewithlegend.js"></script> 
<script>
  $(document).ready(function() {
    var margin = {top: 0, right: 0, bottom: 0, left: 0},
    chart = d3LineWithLegend()
    .xAxis.label('Appointment')
    .width(getWidth())
    .height(getHeight())
    .yAxis.label('Blood Pressure (mmHg)');

    var svg = d3.select('#d3bloodpressure svg')
    .datum(generateData())
    svg.transition().duration(500)
    .attr('width', getWidth())
    .attr('height', getHeight())
    .call(chart);

    chart.dispatch.on('showTooltip', function(e) {
            var offset = $('#d3bloodpressure').offset(), // { left: 0, top: 0 }
            left = e.pos[0] + offset.left,
            top = e.pos[1] + offset.top,
            formatter = d3.format(".04f");

            var dateData = ["Jan 2011", "July 2011", "Jan 2012", "July 2012", "Jan 2013", "July 2013", "Jan 2014", "July 2014", "Jan 2015", "July 2015"]

            var content = '<h3>' + e.series.label + '</h3>' +
            '<p>' +
            '<span class="value">[' + dateData[e.point[0] - 1] + ', ' + formatter(e.point[1]) + ']</span>' +
            '</p>';
            nvtooltip.show([left, top], content);
        });

    chart.dispatch.on('hideTooltip', function(e) {
        nvtooltip.cleanup();
    });

    $(window).resize(function() {
        var margin = chart.margin();

        chart
        .width(getWidth())
        .height(getHeight());

        d3.select('#d3bloodpressure svg')
        .attr('width', getWidth())
        .attr('height', getHeight())
        .call(chart);
    });

    function getWidth() {
        return 1100;
    }

    function getHeight() {
        return 500;
    }

        // populating data
        function generateData() {

            var diastolic = [77, 79, 82, 80, 79, 82, 83, 83, 85, 84]
            var diastolicData = []

            var systolic = [125, 126, 127, 126, 125, 126, 128, 129, 130, 130]
            var systolicData = []


            for (var i = 1; i <= 10; i++) {
              diastolicData.push([i, diastolic[i]]);
              systolicData.push([i, systolic[i]]);
          }

          return [
          {
            data: systolicData,
            label: "Systolic"
        },
        {
            data: diastolicData,
            label: "Diastolic"
        }];
    }});

      // Another graph
      $(document).ready(function() {
        var margin = {top: 0, right: 0, bottom: 0, left: 0},
        chart = d3LineWithLegend()
        .xAxis.label('Appointment')
        .width(getWidth())
        .height(getHeight())
        .yAxis.label('Cholesterol (mg/dl)');

        var svg = d3.select('#d3cholesterol svg')
        .datum(generateData())
        svg.transition().duration(500)
        .attr('width', getWidth())
        .attr('height', getHeight())
        .call(chart);

        chart.dispatch.on('showTooltip', function(e) {
            var offset = $('#d3cholesterol').offset(), // { left: 0, top: 0 }
            left = e.pos[0] + offset.left,
            top = e.pos[1] + offset.top,
            formatter = d3.format(".04f");

            var dateData = ["Jan 2011", "July 2011", "Jan 2012", "July 2012", "Jan 2013", "July 2013", "Jan 2014", "July 2014", "Jan 2015", "July 2015"]

            var content = '<h3>' + e.series.label + '</h3>' +
            '<p>' +
            '<span class="value">[' + dateData[e.point[0] - 1] + ', ' + formatter(e.point[1]) + ']</span>' +
            '</p>';
            nvtooltip.show([left, top], content);
        });

        chart.dispatch.on('hideTooltip', function(e) {
            nvtooltip.cleanup();
        });

        $(window).resize(function() {
            var margin = chart.margin();

            chart
            .width(getWidth())
            .height(getHeight());

            d3.select('#d3cholesterol svg')
            .attr('width', getWidth())
            .attr('height', getHeight())
            .call(chart);
        });

        function getWidth() {
            return 1100;
        }

        function getHeight() {
            return 500;
        }

        // populating data
        function generateData() {

            var LDL = [135, 137, 138, 138, 139, 140, 140, 141, 142, 142]
            var LDLData = []

            var HDL = [40, 39, 39, 38, 37, 37, 36, 35, 35, 34]
            var HDLData = []


            for (var i = 1; i <= 10; i++) {
              LDLData.push([i, LDL[i]]);
              HDLData.push([i, HDL[i]]);
          }

          return [
          {
            data: LDLData,
            label: "LDL"
        },
        {
            data: HDLData,
            label: "HDL"
        }];
    }});

      $(document).ready(function() {
        $.getJSON("https://pure-garden-48064.herokuapp.com/observations", function(json) {
            var resultMatrix = []
            for(i = 0; i < json.Observations.length; i++) {
                var temp = []
                var oCategory = json.Observations[i].ObservationCategory;
                if(oCategory == "Medical") {
                    var oDetails = json.Observations[i].ObservationDetails;
                    if(oDetails == "Hemoglobin [Mass/​volume] in Blood" || oDetails == "Red blood cells (RBC) in blood" || oDetails == "White blood cells (WBC) in blood") {
                        temp.push(oDetails);
                        var oMeasurements = json.Observations[i].Measurements;
                        if(oMeasurements != "N/A") {
                            for(j = 0; j < oMeasurements.length; j++) {
                                temp.push(oMeasurements[j].Measurement);
                                temp.push(oMeasurements[j].Unit);
                                temp.push(oMeasurements[j].Value);
                            }
                        }
                        resultMatrix.push(temp);
                    }
                }
            }
            var resultColumn = [{ title: "Medical Detail" }, { title: "Measurement" }, { title: "Unit" }, { title: "Value" }]

            $('#resultDataTable').DataTable({
                data: resultMatrix,
                columns: resultColumn,
                "responsive": true
            })
        });
    });
</script>

</body>

</html>
